barChart(MSFT)
barChart(Cl(adjustOHLC(MSFT,adjust='split')))
barChart(Cl(adjustOHLC(MSFT)))
rm(MSFT)
getSymbols('DIA')
getOptionChain('DIA')
dia_options<-getOptionChain('DIA')
str(dia_options)
dia_calls<-dia_options$calls
head(dia_calls)
head(DIA)
today<-Sys.Date()
DIA[today]
DIA[today,]
DIA[today,]
today
head(DIa)
gead(DIA)
head(DIA)
tail(DIA)
rm(DIA)
getSymbols(DIA)
getSymbols('DIA')
tail(DIA)
plot(dia_calls)
dia_calls$Strike
plot(dia_calls$Strike)
plot(dia_calls$Strike,type='l')
head(dia_calls)
dia_calls
plot(dia_calls$OI)
plot(dia_calls$OI,type='l')
plot(dia_calls$Strike,type='l')
plot((dia_calls$Bid + dia_calls$Ask)/2),type='l')
plot((dia_calls$Bid + dia_calls$Ask)/2,type='l')
plot((dia_calls$Bid + dia_calls$Ask)/2,dia_calls$Strike,type='l')
plot(dia_calls$Strike,(dia_calls$Bid + dia_calls$Ask)/2,type='l')
today
tail(DIA)
Sys.Date(-1)
Sys.Date()-1
yesterday<-Sys.Date()-1
today
DIA[yesterday]
dia_calls
mean(9,257
8,992
8,848
8,020
7,749
8,172
8,451
8,586
9,199
9,627
9,694
9,675
9,739
10,148
9,958
10,579
10,726
11,383
)
c(9,257
8,992
8,848
8,020
7,749
8,172
8,451
8,586
9,199
9,627
9,694
9,675
9,739
10,148
9,958
10,579
10,726
11,383
)
x<-c(9,257
8,992
8,848
8,020
7,749
8,172
8,451
8,586
9,199
9,627
9,694
9,675
9,739
10,148
9,958
10,579
10,726
11,383
)
x<-c(9257,
8992,
8848,
8020,
7749,
8172,
8451,
8586,
9199,
9627,
9694,
9675,
9739,
10148,
9958,
10579,
10726,
11383,
)
x<-c(9257,
+      8992,
+      8848,
+      8020,
+      7749,
+      8172,
+      8451,
+      8586,
+      9199,
+      9627,
+      9694,
+      9675,
+      9739,
+      10148,
+      9958,
+      10579,
+      10726,
+      11383
+ )
x<-c(9257,
8992,
8848,
8020,
7749,
8172,
8451,
8586,
9199,
9627,
9694,
9675,
9739,
10148,
9958,
10579,
10726,
11383
)
X
x
mean(x)
plot(x)
plot(x,type = 'l')
mean(x)
sd(x)
length(x)
plot(x)
2015-18
auto.arima
hist(x)
plot(density(x))
options(scipen=4)
plot(density(x))
library(forecast)
i<-seq_along(x)
i
df<-data.frame(index=i,count=x)
df
library(ggplot2)
ggplot(df,aes(x=index,y=count))+geom_path()
ggplot(df,aes(x=index,y=count))+geom_path()+geom_smooth(method = 'lm')
mod<-lm(count~index,data = df)
summary(mod)
y<-rnorm(n=18)
y<-y*100
y
plot(y)
hist(x<-c(9257,
+      8992,
+      8848,
+      8020,
+      7749,
+      8172,
+      8451,
+      8586,
+      9199,
+      9627,
+      9694,
+      9675,
+      9739,
+      10148,
+      9958,
+      10579,
+      10726,
+      11383,
+ ))
hist(x<-c(9257,
+      8992,
+      8848,
+      8020,
+      7749,
+      8172,
+      8451,
+      8586,
+      9199,
+      9627,
+      9694,
+      9675,
+      9739,
+      10148,
+      9958,
+      10579,
+      10726,
+      11383,
+ ))
hist(y)
df$y<-y
mody<-lm(y)
mody<-lm(y~index,data=df)
summary(mody)
mody<-lm(abs(y)~index,data=df)
summary(mody)
plot(abs(y))
hist(abs(y))
rm(y)
summary(x)
rnorm(5)
?rnorm
mean(x)
rnorm(n=18,mean=mean(x))->y
y
plot(y)
hist(y)
df$y<-y
mody<-lm(y~index,data = df)
summary(mody)
mody<-lm(index~y,data = df)
summary(mody)
install.packages("forecast")
library(forecast)
auto.arima(x)
plot(auto.arima(x))
forecast(x)
plot(forecast(x))
plot(forecast(auto.arima(x)))
?auto.arima
moda<-auto.arima(x)
coef(x)
coef(moda)
moda
plot(forecast(auto.arima(Cl(DIA))))
plot(forecast(auto.arima(Cl(DIA))))
?forecast
plot(forecast(auto.arima(Cl(DIA)),h=20))
plot(forecast(auto.arima(Cl(DIA)),h=100))
plot(forecast(auto.arima(Cl(DIA)),h=1000))
dmod<-auto.arima(Cl(DIA))
summary(dmod)
forecast(Cl(DIA),h=100)
plot(forecast(Cl(DIA),h=100))
plot(forecast.ar(Cl(DIA),h=100))
plot(forecast.se(Cl(DIA),h=100))
plot(forecast.ets(Cl(DIA),h=100))
?forecast
forecast(moda)
pot(forecast(moda))
plot(forecast(moda))
plot(forecast(dmod))
plot(forecast(dmod,allow.multiplicative.trend=T))
head(di)
head(dia)
head(DIA)
DIA.Adjusted
DIA[DIA.Adjusted]
DIA['DIA.Adjusted']
DIA[2]
DIA[,2]
DIA[,"DIA.Adjusted"]
DIA[,"DIA.Adjusted"]->diaf
forecast(diaf,h=50)
plot(forecast(diaf,h=50))
plot(forecast(diaf,h=50,allow.multiplicative.trend=T))
plot(forecast.HoltWinters(diaf))
HoltWinters(diaf)
diaf
forecast.fracdiff(diaf)
forecast.bats(diaf)
forecast.ets(diaf)
forecast(diaf)
forecast.ets(diaf,h=100)
forecast.lm(diaf)
forecast.lm(diaf)
forecast(diaf,method='lm')
predict(diaf)
predict(diaf,method='lm')
airmiles
plot(fcast(airmiles))
plot(holt(airmiles))
forecast(airmiles)
plot(forecast(airmiles))
meanf(diaf)
stlf(diaf)
croston(diaf)
forecast(diaf)
meanf(dia)
meanf(diaf)
plot(meanf(diaf))
forecast.lm(diaf)
diaf
df<-data.frame(dates=as.Date(row.names(diaf)),price=diaf)
row.names(diaf)
str(diaf)
df<-data.frame(diaf)
ead(df)
head(df)
row.names(df)
df$dates<-as.Date(row.names(df))
head(df)
row.names(df)->NULL
row.names(df)<-NULL
df
head(df)
library(dplyr)
df %>% rename(DIA.Adjusted=price)
df %>% rename(price=DIA.Adjusted)
df %>% rename(price=DIA.Adjusted)->df
head(df)
lmd<-lm(price~dates,data = df)
summary(lmd)
library(ggplot2)
coef(lmd)
ggplot(df,aes(x=dates,y=price))+geom_point()+geom_abline(aes(coef(lmd)))
ggplot(df,aes(x=dates,y=price))+geom_point()
ggplot(df,aes(x=dates,y=price))+geom_line()
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_smooth(method = 'lm')
predict(lm)
forecast.lm(lm)
forecast.lm(lmd)
forecast.lm(lmd,newdata = Sys.Date())
predict(lmd)
plot(predict(lmd))
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_smooth(method = 'lm')
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_abline(coef(lmd))
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_abline(aes(coef(lmd))
)
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_abline(slope = coef(lmd)[2],intercept = coef(lmd)[1])
plot(predict(lmd))
forecast(lmd)
forecast(lmd,newdata = df)
plot(forecast(lmd,newdata = df))
plot(forecast(lmd,newdata = df,confidence=F))
?forecast
plot(forecast(lmd,newdata = df,level = NULL))
plot(forecast(lmd,newdata = df,level = 0))
plot(forecast(lmd,newdata = df,level = 0,h=100))
plot(forecast(lmd,newdata = df,level = 0,h=500))
plot(forecast(lmd,newdata = df,level = 0,h=5000))
ggplot(df,aes(x=dates,y=price))+geom_line()
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_smooth()
ggplot(df,aes(x=dates,y=price))+geom_line()+geom_smooth()
ma(diaf,order = 18)
plot(ma(diaf,order = 18))
plot(ma(diaf,order = 5))
plot(ma(diaf,order = 1))
plot(ma(diaf,order = 200))
forecast(ma(diaf,200))
plot(forecast(ma(diaf,200)))
plot(forecast(ma(diaf,200),n=50))
ses(diaf)
plot(ses(diaf))
ses(diaf,5,initial = 'simple')
plot(ses(diaf,5,initial = 'simple'))
exp<-ses(diaf,100,initial = 'simple')
plot(exp)
exp_accuracy<-accuracy(exp,diaf)
exp;exp_accuracy
plot(exp, ylim=c(0,60))
lines(diaf)
library(Lahman)
library(dplyr)
library(ggplot2)
Batting %>% group_by(playerID,yearID) %>%
summarise(teamID=first(teamID),lgID=first(lgID),G=sum(G),AB=sum(AB),H=sum(H),R=sum(R),RBI=sum(RBI),SB=sum(SB),CS=sum(CS),X2B=sum(X2B),X3B=sum(X3B),HR=sum(HR),BB=sum(BB),IBB=sum(IBB),SH=sum(SH),SF=sum(SF),HBP=sum(HBP),GIDP=sum(GIDP))->bat
bat %>% mutate(X1B=H-X2B-X3B-HR)->bat
bat[is.na(bat)]<-0
head(bat)
head(Fielding)
head(FieldingOF)
bat %>% filter(year>=1980,X2B==max(X2B))
bat %>% filter(yearID>=1980,X2B==max(X2B))
max(bat$X2B)
bat %>% filter(yearID>=1980) %>% filter(X2B==max(X2B))
max(bat$X1B)
bat[bat$X1B==225,]
bat %>% group_by(playerID,yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),player=first(playerID))
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),player=playerID)
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% filter(yearID==1980 & X2B==49)
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B)) %>% arrange(desc(X2B))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B)) %>% arrange(desc(doubles))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B)) %>% arrange(desc(Doubles))
Name <- c("Sam", "Sarah", "Jim", "Fred", "James", "Sally", "Andrew", "John", "Mairin", "Kate", "Sasha", "Ray", "Ed")
Age <- c(22,12,31,35,58,82,17,34,12,24,44,67,43)
Group <- c("A", "B", "B", "B", "B", "C", "C", "D", "D", "D", "D", "D", "D")
data <- data.frame(Name, Age, Group)
data
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),playerID[which(X2B==max(X2B))])
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),playerID[which(X2B==max(X2B))])
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),playerID[which(X2B==max(X2B))])
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),player=playerID[which(X2B==max(X2B))])
bat %>% group_by(playerID,yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),Player=first(playerID))
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),Player=which(max(X2B))
)
bat %>% group_by(yearID,playerID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),Player=playerID[which(X2B==max(X2B))]
)
bat %>% group_by(yearID) %>% filter(yearID>=1980) %>% summarise(Doubles=max(X2B),Player=playerID[which(X2B==max(X2B))]
)
data
data %>% group_by(Group) %>% summarise(Age=max(Age))
data %>% group_by(Group) %>% summarise(Age=max(Age),Name[Age==which.max(Age)])
data %>% group_by(Group) %>% summarise(Age=max(Age),Name[which.max(Age==max(Age))])
data %>% group_by(Group) %>% summarise(Age=max(Age),name=Name[which.max(Age==max(Age))])
x<-c(X,V,III,VI,IV)
x<-c('X','V','III','VI','IV')
as.numeric(X)
as.numeric(x)
as.roman(x)
as.numeric(as.roman(x))
bat %>% filter(yearID>=1980) %>%
group_by(playerID) %>% summarise(Doubles==max(X2B))
group_by(playerID) %>% summarise(Doubles=max(X2B))
bat %>% filter(yearID>=1980) %>%
group_by(playerID) %>% summarise(Doubles=max(X2B))
group_by(playerID) %>% summarise(Doubles=max(X2B)) %>% group_by(yearID) %>% arrange(desc(Doubles))
bat %>% filter(yearID>=1980) %>%
group_by(playerID) %>% summarise(Doubles=max(X2B)) %>% group_by(yearID) %>% arrange(desc(Doubles))
bat.1980<-bat %>% filter(yearID>=1980)
bat.1980 %>% group_by(yearID) %>% summarize(doubles=max(X2B),player=playerID[which.max(X2B==max(X2B))])
bat.1980 %>% group_by(yearID) %>% summarize(doubles=max(X2B),player=playerID[which.max(X2B==max(X2B))])->doubles1980
hist(doubles1980$doubles)
plot(density(doubles1980$doubles))
plot(density(doubles1980$doubles))
plot(density(doubles1980$doubles),fill='red')
plot(density(doubles1980$doubles,fill='red'))
Fielding %>% group_by(playerID,yearID) %>% summarise(E=sum(E),POS=first(POS))->field
field
merge(bat,field)
merge(bat,field)->test
sum(is.na(test))
which(is.na(test))
test[which(is.na(test)),]
sum(is.na(field))
rm(test)
field[is.na(field)]<-0
merge(bat,field)->test
sum(is.na(test))
test1<-left_join(bat,field)
sum(is.na(test1))
sum(is.na(test1$POS))
sum(is.na(test1$E))
1954-977
test1<-right_join(bat,field)
sum(is.na(test1$E))
sum(is.na(test1$POS))
sum(is.na(test1))
test1
1/6+(5/6*(1/6))
1/6+(5/6*(1/6))+(5/6*(1/6))*1/6
1/6+(5/6*(1/6))+((5/6*(1/6))*1/6)+((5/6*(1/6))*1/6)*1/6
n<-numeric()
for(i in 1:200){}
for(i in 1:200){
n<-n+5/6*((1/6)^i)
}
for(i in 1:200){
n<-n+5/6*((1/6)^i)
n
}
for(i in 1:200){
n<-n+5/6*((1/6)^i)
print(n)
}
n<-numeric
rm(n)
n<-numeric()
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
1/3-1/6
bat
bat %>% mutate(points=X1B+R+RBI+BB+SB+(2*X2B)+(4*X3B)+(4*X3B)+(4*HR)-E)->bat
test1 %>% mutate(points=X1B+R+RBI+BB+SB+(2*X2B)+(4*X3B)+(4*X3B)+(4*HR)-E)->test1
head(test1)
sum(is.na(test1$points))
test1 %>% arrange(desc(points))
test1 %>% ungroup() %>% arrange(desc(points)) %>% select(playerID,yearID,points)
